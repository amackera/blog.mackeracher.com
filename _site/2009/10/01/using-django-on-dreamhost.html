<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <title>Using Django on Dreamhost - Anson Writes</title>
    
    <meta name="author" content="Anson MacKeracher" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <link rel="stylesheet" media="screen" href="/stylesheets/screen.css" type="text/css" />
    
    
  </head>
  <body>
    <div id="page">
      <div id="header">
        <a href="/"><h1>Anson Writes</h1></a>
      </div>
      <div id="body">
        <h1>Using Django on Dreamhost</h1>
        <div class="postdate">Posted on 01 Oct 2009</div>

<div class="post">
I am in the process of migrating all my websites from <a title="Pair Networks" href="http://www.pair.com/">Pair</a> hosting to <a title="Dreamhost" href="http://dreamhost.com/">Dreamhost</a>. I managed to get a deal from Dreamhost that I couldn't refuse, and I've been meaning to redesign some of my projects on top of the <a title="Django Project" href="http://www.djangoproject.com/">Django framework</a>, so the switch made sense.

Setting up Django projects on Dreamhost isn't <em>completely</em> painless, however. The <a title="Dreamhost Wiki page on Django" href="http://wiki.dreamhost.com/Django">wiki article</a> is very helpful, but if you're a Django newbie like myself you may get hung up on a few things (like I did). The following is a short tutorial on how to get up and running with Django, with hosting from Dreamhost.
<h3>Getting ready</h3>
Enable FastCGI in your Dreamhost Web Panel under Domains » Manage Domains » (click the domain to be Django-ified):

[caption id="attachment_95" align="aligncenter" width="300" caption="Here is where you want to enable FastCGI"]<img class="size-medium wp-image-95" title="FastCGI" src="http://thesplitbrain.com/wp-content/uploads/2009/05/picture-1-300x133.png" alt="Here is where you want to enable FastCGI" width="300" height="133" />[/caption]

Create a "media" subdomain under Domains » Manage Domains (ex: media.&lt;yourdomain&gt;.com). The media subdomain is where all of your static media files (like images or CSS files) are located. To use these in your Django templates hard-link to the location of the media subdomain (don't worry we'll get to this later).

SSH into your Dreamhost server and create a projects directory in your home folder.
<pre lang="shell">mkdir django_projects</pre>
<h3>Getting and Installing Django</h3>
Once you have set up your environment you're ready to go. Get the most recent stable release of Django's source code through SVN:
<pre lang="shell">svn co http://code.djangoproject.com/svn/django/trunk/ django_src</pre>
This grabs the current release of the Django source code and checks out a working copy to a newly created directory "django_src". Next we must "install" Django by adding it's script locations to our PATH variable. The PATH variable is checked by your shell every time you invoke a command (ex "ls" or "mkdir"). Once we add the Django scripts to our PATH we can execute them in our shell. To do this use your favourite text editor to open up ~/.bash_profile. Add the following lines at the bottom of the file:
<pre lang="shell">export PATH=$PATH:$HOME/django_src/django/bin
export PYTHONPATH=$PYTHONPATH:$HOME/django_src:$HOME/django_projects</pre>
Now that we have included the new directories in our PATH (and our PYTHONPATH, Python's own special PATH variable), you must update your current shell session to reflect the changes. To do this either close and reopen your shell session, or just type:
<pre lang="shell">source ~/.bash_profile</pre>
<h3>Creating your Django project</h3>
The next step is to actually start and configure our Django project! To do this navigate to your django_projects directory created earlier, and start your Django project (replace "myproject" with your new project's intended directory name:
<pre lang="shell">cd ~/django_projects
python django-admin.py startproject myproject
chmod 600 myproject/settings.py</pre>
<h3>Writing an FCGI Dispatcher</h3>
Inside of the directory where your website lives, download this handy FCGI dispatched script written by a generous member of the Dreamhost community:
<pre lang="shell">cd ~/[your domain]
wget http://svn.saddi.com/py-lib/trunk/fcgi.py</pre>
Create a new file called "dispatch.fcgi" and fill it with the following:
<pre lang="shell">#!/usr/bin/python2.4
import sys
sys.path += ['/home/myuser/django_src']
sys.path += ['/home/myuser/django_projects']
from fcgi import WSGIServer
from django.core.handlers.wsgi import WSGIHandler
import os
os.environ['DJANGO_SETTINGS_MODULE'] = 'myproject.settings'
WSGIServer(WSGIHandler()).run()</pre>
Make sure you change the paths to be the directories you defined earlier! This is very important. Next make the newly created files executable:
<pre lang="shell">chmod 755 ~/mydomain.com/dispatch.fcgi ~/mydomain.com/fcgi.py</pre>
<h3>Make yourself an .htaccess file</h3>
Edit ~/[your domain]/.htaccess and add the following:
<pre lang="shell">RewriteEngine On
RewriteBase /
RewriteRule ^(dispatch\.fcgi/.*)$ - [L]
RewriteRule ^(.*)$ dispatch.fcgi/$1 [L]</pre>
Initialize your Django project's database:
<pre lang="shell">~/django_projects/myproject/manage.py syncdb</pre>
Now you should be able to point your browser to www.&lt;your domain&gt;.com and see the "It worked!" page. You're all set with your new Django-powered host.

</div>
 
<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>16 Jan 2012</span> - <a href="/2012/01/16/climbing-and-life.html">Climbing and life</a></li>
    
      <li><span>01 Oct 2011</span> - <a href="/2011/10/01/work-like-you-play.html">Work like you play</a></li>
    
      <li><span>28 Apr 2011</span> - <a href="/2011/04/28/doubts.html">Doubts</a></li>
    
      <li><span>25 Dec 2010</span> - <a href="/2010/12/25/real-time-search-and-the-decentralization-of-information.html">Real-time Search and The Decentralization of Information</a></li>
    
      <li><span>19 Nov 2010</span> - <a href="/2010/11/19/turns-out-bose-headphones-rock.html">Turns out Bose headphones rock</a></li>
    
  </ul>
</div>


      </div>
    </div>

  
  </body>
</html>
